"0","#| label: fig-posterior-predictive-check"
"0","#| fig-cap: Example of a posterior predictive check comparing the observed distribution of the response against those predicted based on the posterior distribution."
"0","#| fig-alt: Several density plots overlaid with one highlighted for comparison."
"0","set.seed(20220110)"
"0",""
"0","fakesample <- tibble("
"0","  y = rexp(100, rate = 3)"
"0",")"
"0",""
"0","fakepost <- tibble("
"0","  variate = seq(1000),"
"0","  lambdapost = rgamma(1000, shape = 100 + 1, rate = sum(fakesample$y))"
"0",") |>"
"0","  mutate(postpred = map(lambdapost, ~ rexp(100, rate = .x)),"
"0","         postbad = map(lambdapost, ~ rnorm(100, mean = 1 / .x, sd = 1 / .x))) |>"
"0","  unnest(cols = c(postpred, postbad)) |>"
"0","  pivot_longer(cols = c(postpred, postbad),"
"0","               values_to = 'posterior',"
"0","               names_to = 'type') |>"
"0","  mutate(type = recode(type,"
"0","                        'postpred' = 'Accurate Model',"
"0","                        'postbad' = 'Inaccurate Model'))"
"0",""
"0","ggplot(data = fakepost,"
"0","       mapping = aes(x = posterior)) +"
"0","  geom_density(mapping = aes(group = variate),"
"0","               color = 'lightblue', alpha = 0.5) +"
"0","  geom_density(data = fakesample,"
"0","               mapping = aes(x = y),"
"0","               color = 'black', linewidth = 1.1) +"
"0","  labs(y = 'Density', "
"0","       x = 'Response') +"
"0","  facet_wrap(~ type, scales = 'free') +"
"0","  theme_bw() +"
"0","  theme(axis.text = element_blank(),"
"0","        axis.ticks = element_blank())"
