<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Bayesian Data Analysis - 15&nbsp; Hypothesis Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03j-constructing-priors.html" rel="next">
<link href="./03h-prediction.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="mystyles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03a-fundamentals.html">Unit III: Fundamentals of Bayesian Inference</a></li><li class="breadcrumb-item"><a href="./03i-hypothesis-testing.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Data Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="./ma483-text.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01a-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit I: Essential Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01b-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Essential Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01c-randomvariables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Random Variables and Distributions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02a-language.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit II: Language of Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02b-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Statistical Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02c-casedeepwater.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Case Study: Health Effects of the Deepwater Horizon Oil Spill</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02d-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Asking the Right Questions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02e-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Gathering the Evidence (Data Collection)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02f-summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Presenting the Evidence (Summarizing Data)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03a-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit III: Fundamentals of Bayesian Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03b-bayesrule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Bayes Rule</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03c-modelingsamples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Modeling Samples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03d-priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Quantifying/Modeling Prior Information</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03e-posteriors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Updating Prior Beliefs (Posterior Distributions)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03f-point-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Point Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03g-interval-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Interval Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03h-prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03i-hypothesis-testing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03j-constructing-priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Constructing Prior Distributions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04a-computation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit IV: Numerical Approaches to Bayesian Computations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04b-mc-integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Monte Carlo Integration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04c-mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Markov Chain Monte Carlo (MCMC)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04d-mcmc-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Assessing MCMC Samples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./05a-comparing-groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit V: Hierarchical Models for Comparing Groups</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05b-study-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Elements of Good Study Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05c-independent-groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Considerations when Comparing Independent Groups</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05d-dependent-groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Considerations when Comparing Related Groups</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./06a-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit VI: Introduction to Regression Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06b-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Regression Models for a Quantitative Response</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06c-reg-extensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Extensions to the Linear Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06d-reg-priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Default Priors in Regression Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06e-qr-factorization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">QR Factorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06f-reg-conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Assessment for Regression Models for the Mean</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06g-categorical-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Regression Models for Categorical Responses</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#point-null-hypotheses" id="toc-point-null-hypotheses" class="nav-link active" data-scroll-target="#point-null-hypotheses"><span class="header-section-number">15.1</span> Point-Null Hypotheses</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison"><span class="header-section-number">15.2</span> Model Comparison</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-hypothesis-testing" class="quarto-section-identifier"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>We have considered both estimation and prediction at this point. The third type of question often asked by researchers is which model (out of some pre-defined set) is most supported by the data. As with previous estimation and prediction, the Bayesian framework seeks to characterize the evidence for each model, given the data.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>For those who are familiar with a classical Frequentist approach to hypothesis testing, you will note that the above language is fundamentally different than the Frequentist perspective. The Frequentist perspective does not allow us to characterize the “evidence” for the null hypothesis, and it would certainly never allow us to quantify the probability of a hypothesis being true.</p>
</div>
</div>
<p>You may recall that for the Naive Classification of College Students example (<a href="03d-priors.html#exm-naive">Example&nbsp;<span>10.1</span></a>), we derived the following posterior distribution (see <a href="03e-posteriors.html#eq-naive-posterior">Equation&nbsp;<span>11.3</span></a>):</p>
<p><span class="math display">\[\pi(\theta \mid y) = (0.7169)\delta(\theta - 0.246) + (0.2831)\delta(\theta - 0.563).\]</span></p>
<p>This posterior distribution followed from learning 3 of the 10 students identify as female combined with the prior belief that there was a 60% chance the students were from ISU.</p>
<p>This example is nice for illustrating hypothesis testing because baked into the problem were essentially two hypotheses:</p>
<p><span class="math display">\[H_0: \theta = 0.246 \qquad \text{vs.} \qquad H_1: \theta = 0.563\]</span></p>
<p>where the null hypothesis represents the belief that the students are from Rose-Hulman (where 24.6% of students identify as female) and the alterntative hypothesis represents the belief that the students are from ISU (where 56.3% of students identify as female). In this example, each hypothesis specifies a single value for the parameter; in general, each hypothesis could specify a region for the parameter. That is, we are generally interested in testing</p>
<p><span class="math display">\[H_0: \theta \in \Theta_0 \qquad \text{vs.} \qquad H_1: \theta \in \Theta_1.\]</span></p>
<p>While not a requirement, in practice <span class="math inline">\(\Theta_0\)</span> and <span class="math inline">\(\Theta_1\)</span> are typically mutually exclusive sets which form a partition of the parameter space.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nothing prohibits us from having more than two hypotheses in this framework, and nothing requires the hypotheses form a partition of the parameter space.</p>
</div>
</div>
<p>Under the Bayesian framework, it is straightforward to compute probabilities of the form “the probability <span class="math inline">\(H_j\)</span> is true given the data observed.”</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Under the classical Frequentist perspective, the probability a hypothesis is true is nonsensical; however, under the Bayesian approach, we are using probability simply to characterize our uncertainty about the statement.</p>
</div>
</div>
<p>For the Naive Classification of College Students, the posterior naturally allows us to address the hypothesis. Notice that</p>
<p><span class="math display">\[
\begin{aligned}
  Pr\left(H_0 \mid y\right) &amp;= Pr(\theta = 0.246 \mid y) = 0.7169 \\
  Pr\left(H_1 \mid y\right) &amp;= Pr(\theta = 0.563 \mid y) = 0.2831.
\end{aligned}
\]</span></p>
<p>That is, after observing the data, we believe it is much more likely the the students are from Rose-Hulman than from ISU.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Again, contrasting the conclusion in the Bayesian framework with a classical Frequentist framework, we are saying that the data is convincing us to believe the null hypothesis over the alternative. The idea of “accepting” the null hypothesis in the classical Frequentist framework is heretical.</p>
</div>
</div>
<p>In addition to computing the probability of each hypothesis, we can compute how much more likely we are to believe the students are from Rose-Hulman compared to believing they are from ISU:</p>
<p><span class="math display">\[\frac{Pr\left(H_0 \mid y\right)}{Pr\left(H_1 \mid y\right)} = 2.53;\]</span></p>
<p>that is, given the data, we believe it is 2.53 times more likely that the students are from Rose-Hulman than from ISU. This is known as the posterior odds.</p>
<div id="def-posterior-odds" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 15.1 (Posterior Odds) </strong></span>Let <span class="math inline">\(H_j\)</span> denote the hypothesis that <span class="math inline">\(\theta \in \Theta_j\)</span> for some region <span class="math inline">\(\Theta_j\)</span>. Then, the posterior odds <em>in favor of</em> <span class="math inline">\(H_j\)</span> is given by</p>
<p><span class="math display">\[\frac{Pr\left(\theta \in \Theta_j \mid \mathbf{y}\right)}{Pr\left(\theta \notin \Theta_j \mid \mathbf{y}\right)}.\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When there are only two hypotheses, and they partition the parameter space, then the posterior odds captures how strongly we favor one hypothesis over the other given the data.</p>
</div>
</div>
<p>The posterior odds is useful, but it only suggests how we feel after we have observed the data. We may be more interested in how much the data <em>impacted</em> our prior beliefs. For example, if the data simply confirmed our beliefs, that is not nearly as extraordinary as the data completely reversing our beliefs. The Bayes Factor captures this impact.</p>
<div id="def-bayes-factor" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 15.2 (Bayes Factor) </strong></span>A measure of how the observed data <em>alters</em> your prior beliefs about a hypothesis. Let <span class="math inline">\(H_j\)</span> denote the hypothesis that <span class="math inline">\(\theta \in \Theta_j\)</span> for some region <span class="math inline">\(\Theta_j\)</span>. The Bayes Factor <em>in favor of</em> <span class="math inline">\(H_j\)</span> is the ratio of the posterior odds in favor of <span class="math inline">\(H_j\)</span> to the prior odds in favor of <span class="math inline">\(H_j\)</span>:</p>
<p><span class="math display">\[BF_j = \left(\frac{Pr\left(\theta \in \Theta_j \mid \mathbf{y}\right)}{Pr\left(\theta \notin \Theta_j \mid \mathbf{y}\right)}\right)\left(\frac{Pr\left(\theta \notin \Theta_j\right)}{Pr\left(\theta \in \Theta_j\right)}\right).\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Some prefer to report the logarithm of the Bayes Factor, as it is a quantity that is easier to work with in theoretical derivations.</p>
</div>
</div>
<p>Keep in mind, the Bayesian framework is about quantifying our uncertainty about the unknown parameters. The Bayes Factor measures how that uncertainty has been impacted by the observed data. Two independent papers made recommendations for how to interpret a Bayes Factor; however, we should remember that these are simply “rules of thumb.”</p>
<div id="tbl-bayes-factor" class="anchored">
<div class="table-responsive">
<table class="table-striped table">
<caption>Table&nbsp;15.1: Rules of thumb for interpreting the Bayes Factor as suggested by Jeffreys and Kass and Raftery.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Strength of Evidence</th>
<th style="text-align: center;">Jeffreys’ Scale</th>
<th style="text-align: center;">Kass and Raftery Scale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Weak</td>
<td style="text-align: center;"><span class="math inline">\(0 \leq \log_{10}(BF) &lt; 0.5\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0 \leq \log(BF) &lt; 1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Substantial</td>
<td style="text-align: center;"><span class="math inline">\(0.5 \leq \log_{10}(BF) &lt; 1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1 \leq \log(BF) &lt; 3\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Strong</td>
<td style="text-align: center;"><span class="math inline">\(1 \leq \log_{10}(BF) &lt; 2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(3 \leq \log(BF) &lt; 5\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Decisive</td>
<td style="text-align: center;"><span class="math inline">\(2 \leq \log_{10}(BF)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(5 \leq \log(BF)\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Take caution when interpreting a Bayes Factor; it quantifies the degree to which the data altered your prior beliefs. It is possible to have a really small Bayes Factor in favor of a hypothesis and yet simultaneously believe overwhelmingly in that hypothesis given the data; the small Bayes Factor simply implies that you believed in that hypothesis before collecting the data as well. Conversely, it is possible to have a really large Bayes Factor in favor of a hypothesis and yet simultaneously not distinguish between that hypothesis and another given the data; the large Bayes Factor simply implies that your beliefs about that hypothesis have dramatically changed.</p>
</div>
</div>
<p>For the Classification of College Students example (<a href="03d-priors.html#exm-naive">Example&nbsp;<span>10.1</span></a>), our Bayes Factor, in favor of students being from Rose-Hulman, is given by</p>
<p><span class="math display">\[BF_{0} = \left(\frac{0.7169}{0.2831}\right)\left(\frac{0.6}{0.4}\right) = 3.80.\]</span></p>
<p>The log-Bayes Factor is then 1.33, which falls under the “substantial evidence” category in the Kass and Raftery scale. This Bayes Factor is capturing the idea that we are still somewhat divided on the issue, but we have switched from favoring that the students are from ISU to favoring that the students are from Rose-Hulman. The data led to a shift in our beliefs.</p>
<section id="point-null-hypotheses" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="point-null-hypotheses"><span class="header-section-number">15.1</span> Point-Null Hypotheses</h2>
<p>Technically speaking, hypothesis testing in the Bayesian framework requires little; the posterior distribution allows us to quantify our uncertainty about parameters (or corresponding hypotheses) given the data. However, there is a common scenario which has a potential pitfall worth discussion. Consider testing the following hypotheses:</p>
<p><span class="math display">\[H_0: \theta = \theta_0 \qquad \text{vs.} \qquad H_1: \theta \neq \theta_0\]</span></p>
<p>where here <span class="math inline">\(\Theta_0 = \{\theta_0\}\)</span> is a singleton set. This is known as a “point-null hypothesis,” and it poses a problem for many prior distributions. To illustrate, consider computing the prior odds in favor of <span class="math inline">\(H_1\)</span>:</p>
<p><span id="eq-hyp-post-odds"><span class="math display">\[\frac{Pr\left(\theta \neq \theta_0\right)}{Pr\left(\theta = \theta_0\right)} = \frac{\int_{\theta \neq \theta_0}^{} \pi(\theta) d\theta}{\int_{\theta = \theta_0}^{} \pi(\theta) d\theta}. \tag{15.1}\]</span></span></p>
<p>For any continuous prior distribution, the numerator in <a href="#eq-hyp-post-odds">Equation&nbsp;<span>15.1</span></a> will be 1 and the denominator will be 0! For any continuous distribution, the probability the random variable takes a specific value is 0; therefore, a continuous prior distribution is incompatible with a point-null hypothesis. The continuous prior distribution communicates you are infinitely more likely to believe the parameter takes any value other than <span class="math inline">\(\theta_0\)</span>. There is a misalignment of beliefs; if you are truly interested in testing a point-null hypothesis, you must believe the null hypothesis has some probability of describing reality. Therefore, the prior distribution must incorporate the belief that <span class="math display">\[Pr\left(H_0\right) &gt; 0\]</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Big Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can only test a hypothesis if, a priori, we believe there is some chance the hypothesis is true. If we go into a study believing something is impossible, no amount of data will convince us otherwise.</p>
</div>
</div>
<p>One way of incorporating our prior beliefs about a point-null hypothesis is specifying a mixture distribution.</p>
<div id="def-mixture-distribution" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 15.3 (Mixture Distribution) </strong></span>Let <span class="math inline">\(X\)</span> be a random variable and <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span> be valid density functions defined on a common support. Then,</p>
<p><span class="math display">\[h(x) = wf(x) + (1 - w) g(x),\]</span></p>
<p>where <span class="math inline">\(0 &lt; w &lt; 1\)</span>, is known as a mixture distribution.</p>
</div>
<p>Appropriately applied, a mixture distribution allows us to place mass on the value of <span class="math inline">\(\theta_0\)</span> in a point-null hypothesis and spread out the remaining probability along the support.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mixture Prior for Point-Null Hypotheses
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(\theta\)</span> be a parameter which has support <span class="math inline">\(\Theta\)</span>, and consider testing the hypotheses</p>
<p><span class="math display">\[H_0: \theta = \theta_0 \qquad \text{vs.} \qquad H_1: \theta \neq \theta_0\]</span></p>
<p>for some <span class="math inline">\(\theta_0 \in \Theta\)</span>. Suppose, a priori, we believe <span class="math inline">\(Pr\left(\theta = \theta_0\right) = u\)</span> for some <span class="math inline">\(0 &lt; u &lt; 1\)</span>. Then,</p>
<p><span class="math display">\[\pi(\theta) = u \delta\left(\theta - \theta_0\right) + (1 - u) \pi_0(\theta)\]</span></p>
<p>is a suitable family of prior distributions, where <span class="math inline">\(\pi_0(\theta)\)</span> is any continuous distribution on the support <span class="math inline">\(\Theta\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>A mixture prior with a point mass is not a continuous distribution, nor is it a discrete distribution.</p>
</div>
</div>
<div id="exm-csec-hypotheses" class="theorem example">
<p><span class="theorem-title"><strong>Example 15.1 (C-section Deliveries Continued) </strong></span><a href="03c-modelingsamples.html#exm-csec">Example&nbsp;<span>9.1</span></a> introduced a study, a component of which includes estimating the probability of a mother undergoing a C-section delivery at a particular hospital.</p>
<p>Suppose the hospital is interested in testing</p>
<p><span class="math display">\[H_0: \theta = 0.304 \qquad \text{vs.} \qquad H_1: \theta \neq 0.304.\]</span></p>
<p>The null hypothesis represents the C-section rate at the hospital being equivalent to the rate across the state of Indiana. Suppose we believe, prior to observing any data, either hypothesis is equally likely. Combining this belief with those expressed in <a href="03d-priors.html#exm-csec-prior">Example&nbsp;<span>10.2</span></a>, a reasonable prior distribution has the form</p>
<p><span class="math display">\[\pi(\theta) = 0.5 \delta(\theta - 0.304) + 0.5 \frac{\Gamma(a + b)}{\Gamma(a)\Gamma(b)}\theta^{a-1}(1-\theta)^{b-1},\]</span></p>
<p>where <span class="math inline">\(a = 10.3\)</span> and <span class="math inline">\(b = 23.6\)</span>. Note that the mass at <span class="math inline">\(\theta_0 = 0.304\)</span> led to different values of hyperparameters in <span class="math inline">\(\pi_0(\theta)\)</span> compared to <a href="03d-priors.html#exm-csec-prior">Example&nbsp;<span>10.2</span></a>. The resulting posterior will have the form</p>
<p><span class="math display">\[\pi(\theta \mid \mathbf{x}) = w \delta(\theta - 0.304) + (1 - w) \frac{\Gamma(a + b + n + n\bar{x})}{\Gamma(a + n)\Gamma(b + n\bar{x})} \theta^{a + n - 1} (1 - \theta)^{b + n\bar{x} - 1},\]</span></p>
<p>where</p>
<p><span class="math display">\[w = \frac{(0.5)(0.304)^n (1 - 0.304)^{n\bar{x}}}{(0.5)(0.304)^n(1-0.304)^{n\bar{x}} + (0.5) \frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\frac{\Gamma(a + n)\Gamma(b + n\bar{x})}{\Gamma(a + b + n + n\bar{x})}},\]</span></p>
<p>the sample size <span class="math inline">\(n\)</span> and sample mean <span class="math inline">\(\bar{x}\)</span> are given by the data, and the hyperparameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> were defined above.</p>
<p>Using this posterior distribution, describe our belief about the hypotheses.</p>
</div>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Notice that the form of the posterior distribution directly encodes our belief about the null hypothesis given the data. Specifically,</p>
<p><span class="math display">\[Pr\left(\theta = \theta_0 \mid \mathbf{x}\right) = w = 0.6098.\]</span></p>
<p>The posterior odds in favor of the null hypothesis is</p>
<p><span class="math display">\[\frac{Pr\left(\theta = \theta_0 \mid \mathbf{x}\right)}{Pr\left(\theta \neq \theta_0 \mid \mathbf{x}\right)} = 1.56,\]</span></p>
<p>and the Bayes Factor is the same (since the prior odds were 1). The data strengthened our belief in the null hypothesis, but not by much.</p>
</div>
</section>
<section id="model-comparison" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="model-comparison"><span class="header-section-number">15.2</span> Model Comparison</h2>
<p>Hypothesis testing is a special case of model comparison, where in the Bayesian framework the “model” consists of <em>both</em> the likelihood and the prior.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Big Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>A Bayesian model consists of the choice for the likelihood as well as the choice for the prior.</p>
</div>
</div>
<p>Consider the Naive Classification of College Students (<a href="03d-priors.html#exm-naive">Example&nbsp;<span>10.1</span></a>); we can reframe the problem as a choice between two models:</p>
<p><span class="math display">\[
\begin{aligned}
  \text{Model 0}:&amp; \quad \pi(\theta) = \delta(\theta - 0.246) \\
    &amp;\quad f(y \mid \theta) = \binom{n}{\theta} \theta^y (1-\theta)^{n-y} \\
  \text{Model 1}:&amp; \quad \pi(\theta) = \delta(\theta - 0.563) \\
    &amp;\quad f(y \mid \theta) = \binom{n}{\theta} \theta^y (1-\theta)^{n-y},
\end{aligned}
\]</span></p>
<p>where we believed, a priori, that <span class="math inline">\(Pr(\text{Model 1}) = 0.4\)</span> and <span class="math inline">\(Pr(\text{Model 2}) = 0.6\)</span>. In this case, the models differed only in their choice of prior (which here simplifies further to which value of the parameter to select). This simplification allowed us to choose between these two models by working only with the posterior distribution.</p>
<p>We would like to generalize this process to allow the model to alter both the likelihood and the prior distribution, and for us to place some prior probability on the entirety of the model. We are then interested in using the data to quantify the evidence for each model. To do this, we essentially consider the model <span class="math inline">\(\mathcal{M}\)</span> to be a parameter. This is known as a <em>hierarchical model</em> because the priors on the parameter are conditional on the model, and then a further prior is placed on the model itself (it is a multi-level model).</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model Comparison
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(\mathcal{M}_j\)</span> represent the <span class="math inline">\(j\)</span>-th potential model for a data generating process. Reflect the likelihood and prior as a function of the model. For example, write</p>
<p><span class="math display">\[
\begin{aligned}
  \text{Model 0}:&amp; \quad f_0(\mathbf{y} \mid \theta_0, \mathcal{M}_0) \\
    &amp; \quad \pi_0(\theta_0 \mid \mathcal{M}_0) \\
    &amp; \quad \pi(\mathcal{M}_0) = Pr(\mathcal{M}_0) \\
  \text{Model 1}:&amp; \quad f_1(\mathbf{y} \mid \theta_1, \mathcal{M}_1) \\
    &amp; \quad \pi_1(\theta_1 \mid \mathcal{M}_1) \\
    &amp; \quad \pi(\mathcal{M}_1) = Pr(\mathcal{M}_1). \\
\end{aligned}
\]</span></p>
<p>Notice we (potentially) allow the form of the likelihood, the parameters governing that likelihood, and the form of the prior to differ for each model. Our prior beliefs about the parameter are captured within each prior, but we also have prior beliefs about the model itself — how likely each model is. We are interested in determining <span class="math inline">\(Pr(\mathcal{M}_j \mid \mathbf{Y})\)</span> for each <span class="math inline">\(j\)</span>.</p>
</div>
</div>
<p>An iterated application of Bayes Theorem allows us to write the likelihood of each model, given the data, as</p>
<p><span class="math display">\[
\begin{aligned}
  Pr\left(\mathcal{M}_j \mid \mathbf{Y}\right)
    &amp;= \frac{f_j(\mathbf{y} \mid \mathcal{M}_j) Pr(\mathcal{M}_j)}{\sum_{j} f_j(\mathbf{y} \mid \mathcal{M}_j) Pr(\mathcal{M}_j)} \\
  f_j(\mathbf{y} \mid \mathcal{M}_j)
    &amp;= \int f_j(\mathbf{y} \mid \theta_j, \mathcal{M}_j) \pi_j(\theta_j \mid \mathcal{M}_j) d\theta_j.
\end{aligned}
\]</span></p>
<div id="def-evidence" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 15.4 (Evidence for a Model) </strong></span>Under the Model Comparison framework defined above, the evidence for model <span class="math inline">\(\mathcal{M}_j\)</span> is defined as</p>
<p><span class="math display">\[f_j(\mathbf{y} \mid \mathcal{M}_j) = \int f_j(\mathbf{y} \mid \theta_j, \mathcal{M}_j) \pi_j(\theta_j \mid \mathcal{M}_j) d\theta_j.\]</span></p>
</div>
<p>The evidence for a model is a number; since it is a function only of observed data, once we observe the data, the evidence is a constant. We can also think of the evidence as the prior predictive distribution under a particular model evaluated at the observed data.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>It may seem strange to use the prior predictive distribution when defining the evidence instead of the posterior predictive, but keep in mind that within model comparison, the <em>model itself</em> is the parameter of interest. Changing either the likelihood or the prior will impact the evidence.</p>
</div>
</div>
<p>The evidence can also be used to compute the Bayes Factor for one model over another.</p>
<div id="def-bayes-factor-models" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 15.5 (Bayes Factor for Model Comparison) </strong></span>The Bayes Factor, in favor of Model 1, is</p>
<p><span class="math display">\[
\begin{aligned}
  BF_{1} &amp;= \left(\frac{Pr(\mathcal{M}_1 \mid \mathbf{y})}{Pr(\mathcal{M}_0 \mid \mathbf{y})}\right)\left(\frac{Pr(\mathcal{M}_0)}{Pr(\mathcal{M}_1)}\right) \\
    &amp;= \left(\frac{f_1(\mathbf{y} \mid \mathcal{M}_1) Pr(\mathcal{M}_1)}{f_0(\mathbf{y} \mid \mathcal{M}_0) Pr(\mathcal{M}_0)}\right)\left(\frac{Pr(\mathcal{M}_0)}{Pr(\mathcal{M}_1)}\right) \\
    &amp;= \frac{f_1(\mathbf{y} \mid \mathcal{M}_1)}{f_0(\mathbf{y} \mid \mathcal{M}_0)}.
\end{aligned}
\]</span></p>
<p>That is, the Bayes Factor is a ratio of the evidence for each model.</p>
</div>
<p>Model comparison simply extends our framework by the inclusion of another parameter. That parameter, the model itself, just happens to be discrete. Our goal is to use our machinery to quantify the uncertainty in each model given the data observed.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03h-prediction.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Prediction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03j-constructing-priors.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Constructing Prior Distributions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>