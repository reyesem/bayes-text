<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Bayesian Data Analysis - 14&nbsp; Prediction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03i-hypothesis-testing.html" rel="next">
<link href="./03g-interval-estimation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="mystyles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03a-fundamentals.html">Unit III: Fundamentals of Bayesian Inference</a></li><li class="breadcrumb-item"><a href="./03h-prediction.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Prediction</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Data Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="./ma483-text.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01a-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit I: Essential Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01b-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Essential Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01c-randomvariables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Random Variables and Distributions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02a-language.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit II: Language of Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02b-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Statistical Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02c-casedeepwater.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Case Study: Health Effects of the Deepwater Horizon Oil Spill</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02d-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Asking the Right Questions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02e-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Gathering the Evidence (Data Collection)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02f-summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Presenting the Evidence (Summarizing Data)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03a-fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit III: Fundamentals of Bayesian Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03b-bayesrule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Bayes Rule</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03c-modelingsamples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Modeling Samples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03d-priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Quantifying/Modeling Prior Information</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03e-posteriors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Updating Prior Beliefs (Posterior Distributions)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03f-point-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Point Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03g-interval-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Interval Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03h-prediction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03i-hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03j-constructing-priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Constructing Prior Distributions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04a-computation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit IV: Numerical Approaches to Bayesian Computations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04b-mc-integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Monte Carlo Integration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04c-mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Markov Chain Monte Carlo (MCMC)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04d-mcmc-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Assessing MCMC Samples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./05a-comparing-groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit V: Hierarchical Models for Comparing Groups</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05b-study-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Elements of Good Study Design</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05c-independent-groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Considerations when Comparing Independent Groups</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05d-dependent-groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Considerations when Comparing Related Groups</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./06a-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unit VI: Introduction to Regression Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06b-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Regression Models for a Quantitative Response</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06c-reg-extensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Extensions to the Linear Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06d-reg-priors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Default Priors in Regression Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06e-qr-factorization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">QR Factorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06f-reg-conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Assessment for Regression Models for the Mean</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06g-categorical-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Regression Models for Categorical Responses</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Glossary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#derivation-of-the-posterior-predictive" id="toc-derivation-of-the-posterior-predictive" class="nav-link active" data-scroll-target="#derivation-of-the-posterior-predictive"><span class="header-section-number">14.1</span> Derivation of the Posterior Predictive</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">14.2</span> Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-prediction" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Prediction</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Previous chapters have focused on making a statement about the parameter given the data. However, researchers are often interested in using the data to predict what might occur in the future. Hopefully, by now you realize that within the Bayesian framework, we are never interested <em>solely</em> in a point estimate. So, when we say we are interested in “prediction,” we mean we are interested in characterizing our uncertainty in a future value given the data we have observed. As this statement is not directly about the parameter, the posterior distribution does <strong>not</strong> contain the relevant information; but, it can be used to derive the distribution that is relevant.</p>
<p>Imagine we have not yet collected data. Given only our prior beliefs, how might we characterize a future observation (one not yet observed)? We may not know what value a future observation will take, but we have some sense of the process that will generate it if we have posited a likelihood to describe the data generating process.</p>
<p>In probability, we routinely use the distribution to characterize future values each time we answered a question like “what is the probability we will observe a value between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>?” It is therefore intuitive that we might turn toward the likelihood <span class="math inline">\(f(\mathbf{y} \mid \theta)\)</span> to describe the variability in data that has not yet been observed. Of course, this highlights the difference between probability and statistics — in probability, we always knew the value of <span class="math inline">\(\theta\)</span>, but in statistics, we do not. Without a value of <span class="math inline">\(\theta\)</span> to plug into the density, we are unable to use it to compute probabilities about future observations (or, more precisely, any probabilities we computed would be a function of the unknown parameter).</p>
<p>This is where our prior beliefs come into play. While we do not know the value of <span class="math inline">\(\theta\)</span>, we do have some prior beliefs about it, and these are captured in the prior distribution. The Bayesian framework proposes marginalizing out the parameter — essentially taking a weighted average over all possible values it could be. What results is not a single value, but a distribution of values known as the prior predictive distribution.</p>
<div id="def-prior-predictive-distribution" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 14.1 (Prior Predictive Distribution) </strong></span>The prior predictive distribution is the marginal distribution of the response(s) prior to observing any data:</p>
<p><span class="math display">\[m(\mathbf{y}) = \int f(\mathbf{y} \mid \theta) \pi(\theta) d\theta.\]</span></p>
<p>The distribution marginalizes the parameter out of the likelihood using the beliefs from the prior distribution.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The prior predictive distribution is the denominator in Bayes Theorem.</p>
</div>
</div>
<p>While rarely used directly, the prior predictive distribution provides a way of characterizing our uncertainty in future observations based solely on our beliefs about <span class="math inline">\(\theta\)</span> prior to observing any data.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Big Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can describe our beliefs about future values of the response by marginalizing the parameter out of the likelihood.</p>
</div>
</div>
<p>Of course, we will eventually collect data, and we would like to take this knowledge into account. After observing the data, the parameter remains unknown; however, our beliefs about the parameter are updated (and are captured in the posterior distribution). We want to marginalize the parameter out of the likelihood while accounting for these updated beliefs.</p>
<p>We consider swapping out the role of the prior distribution in <a href="#def-prior-predictive-distribution">Definition&nbsp;<span>14.1</span></a> with the posterior distribution. The result is the posterior predictive distribution.</p>
<div id="def-posterior-predictive-distribution" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 14.2 (Posterior Predictive Distribution) </strong></span>Let <span class="math inline">\(\mathbf{Y}^*\)</span> represent a collection of <span class="math inline">\(m\)</span> <em>future</em> observations. The distribution of these future observations given the observed data <span class="math inline">\(\mathbf{Y}\)</span> (of length <span class="math inline">\(n\)</span>), called the posterior predictive distribution, is given by</p>
<p><span class="math display">\[\pi\left(\mathbf{y}^* \mid \mathbf{y}\right) = \int f\left(\mathbf{y}^* \mid \theta\right) \pi(\theta \mid \mathbf{y}) d\theta.\]</span></p>
</div>
<p>While this definition is correct, its derivation requires some additional constraints on the data generating process. We present the derivation below primarily to combat any misconceptions about what is happening in the integration above.</p>
<section id="derivation-of-the-posterior-predictive" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="derivation-of-the-posterior-predictive"><span class="header-section-number">14.1</span> Derivation of the Posterior Predictive</h2>
<p>Let <span class="math inline">\(\mathbf{Y}^*\)</span> denote a collection of <span class="math inline">\(m\)</span> future (or new) observations not yet observed. This is distinguished from the collection of <span class="math inline">\(n\)</span> observations we have already made <span class="math inline">\(\mathbf{Y}\)</span>. We impose the following two conditions/assumptions on the data generating process:</p>
<ul>
<li>Given the value of the parameter, the likelihood of <span class="math inline">\(\mathbf{Y}^*\)</span> has the same form as the likelihood of of the observed data <span class="math inline">\(\mathbf{Y}\)</span>.</li>
<li>Given the value of the parameter, the observed data <span class="math inline">\(\mathbf{Y}\)</span> is <em>independent</em> of the new observations <span class="math inline">\(\mathbf{Y}^*\)</span>.</li>
</ul>
<p>The first condition essentially states the data generated under one process should only be used to predict data generated from the same process. Intuitively, when we collect data, it can only inform us about the process from which it was generated. Therefore, our future observations are always related in some way to the likelihood, as that models the data generating process of interest.</p>
<p>The second condition extends the concept of independence presented in a typical probability course. This is <em>conditional independence</em>.</p>
<div id="def-conditional-independence" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 14.3 (Conditional Independence) </strong></span>Two random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are said to be independent, conditional on (or “given”) <span class="math inline">\(Z\)</span> if, and only if,</p>
<p><span class="math display">\[f_{(X,Y) \mid Z} (x, y \mid z) = f_{X \mid Z}(x \mid z) f_{Y \mid Z}(y \mid z).\]</span></p>
</div>
<p>Conditional independence is common in statistical theory. Two random quantities are somehow related, but given an additional piece of information become independent. That is, all the information about the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is contained in the random variable <span class="math inline">\(Z\)</span>.</p>
<p>Returning to the stated condition, we are saying that the only thing the new and old observations have in common is the data generating process; once we know the quantities that govern this process (the parameters), then we can gain no further knowledge about the new observations from the old observations. That is, if someone told you what the parameters were, there would be no need to collect data — you would know everything possible for predicting a future observation. So, the data observed is only useful in that it informs our beliefs about the unknown parameters.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Big Idea
</div>
</div>
<div class="callout-body-container callout-body">
<p>The data observed informs our beliefs about the parameters in the data generating process. It is only through what the data tells us about the parameters that the data is useful in predicting a future observation.</p>
</div>
</div>
<p>We are now prepared to derive the posterior predictive distribution. Recall that a marginal distribution can be constructed by integrating over the other elements of a joint distribution. For example,</p>
<p><span class="math display">\[f\left(\mathbf{y}^*\right) = \int f\left(\mathbf{y}^*, \theta\right) d\theta.\]</span></p>
<p>Here, we have considered the joint distribution of the new data <span class="math inline">\(\mathbf{Y}^*\)</span> and the parameter <span class="math inline">\(\theta\)</span>, then integrated over <span class="math inline">\(\theta\)</span>. This strategy works even when we are carrying a conditional term through. That is, we have that</p>
<p><span id="eq-post-pred-step1"><span class="math display">\[\pi\left(\mathbf{y}^* \mid \mathbf{y}\right) = \int f\left(\mathbf{y}^*, \theta \mid \mathbf{y}\right) d\theta. \tag{14.1}\]</span></span></p>
<p>Here, we have considered the joint distribution of the new data <span class="math inline">\(\mathbf{Y}^*\)</span> and the parameter <span class="math inline">\(\theta\)</span> (conditional on the observed data), then integrated over <span class="math inline">\(\theta\)</span>. This statement would have been true for any choice of random variable, but using the parameter allows us to make use of the information we have collected through the observed data.</p>
<p>We now recall that any joint distribution can be written as the product of a conditional distribution and a marginal distribution; this is true even if we are already conditioning on another random variable. This gives</p>
<p><span id="eq-post-pred-step2"><span class="math display">\[f(\mathbf{y}^*, \theta \mid \mathbf{y}) = f(\mathbf{y}^* \mid \mathbf{y}, \theta) \pi(\theta \mid \mathbf{y}). \tag{14.2}\]</span></span></p>
<p>Substituting <a href="#eq-post-pred-step2">Equation&nbsp;<span>14.2</span></a> into <a href="#eq-post-pred-step1">Equation&nbsp;<span>14.1</span></a>, we now have that the posterior predictive distribution is given by</p>
<p><span id="eq-post-pred-step3"><span class="math display">\[\pi\left(\mathbf{y}^* \mid \mathbf{y}\right) = \int f(\mathbf{y}^* \mid \mathbf{y}, \theta) \pi(\theta \mid \mathbf{y}) d\theta. \tag{14.3}\]</span></span></p>
<p>We now make use of conditional independence. We now consider the term <span class="math inline">\(f(\mathbf{y}^* \mid \mathbf{y}, \theta)\)</span> inside the integral. By the definition of a conditional density, we have</p>
<p><span class="math display">\[f(\mathbf{y}^* \mid \mathbf{y}, \theta) = \frac{f(\mathbf{y}^*, \mathbf{y} \mid \theta)}{f(\mathbf{y} \mid \theta)}.\]</span></p>
<p>However, if we are willing to assume that <span class="math inline">\(\mathbf{Y}^*\)</span> is independent of <span class="math inline">\(\mathbf{Y}\)</span> given <span class="math inline">\(\theta\)</span>, then the numerator becomes the product of <span class="math inline">\(f(\mathbf{y}^* \mid \theta)\)</span> and <span class="math inline">\(f(\mathbf{y} \mid \theta)\)</span>, meaning we have that <span class="math inline">\(f(\mathbf{y}^* \mid \mathbf{y}, \theta) = f(\mathbf{y}^* \mid \theta)\)</span> under conditional independence. Substituting in this expression into <a href="#eq-post-pred-step3">Equation&nbsp;<span>14.3</span></a> gives the posterior predictive distribution in <a href="#def-posterior-predictive-distribution">Definition&nbsp;<span>14.2</span></a>.</p>
</section>
<section id="summary" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="summary"><span class="header-section-number">14.2</span> Summary</h2>
<p>Once you have the posterior predictive distribution, you have everything there is to know about future observations given the data observed. Further, the posterior predictive distribution can be summarized just like any other distribution. Summarizing the location (mean, median, mode) would result in point estimates for future observations. Alternatively, we can construct interval estimates by defining a range for which the future observations would fall with some known probability.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Keep in mind that we have switched our focus. We are now focused on a possible data point, not a parameter. Therefore, the support of the posterior predictive need not be the same as the support of the posterior distribution.</p>
</div>
</div>
<div id="exm-csec-prediction" class="theorem example">
<p><span class="theorem-title"><strong>Example 14.1 (C-section Deliveries Continued) </strong></span><a href="03c-modelingsamples.html#exm-csec">Example&nbsp;<span>9.1</span></a> introduced a study, a component of which includes estimating the probability of a mother undergoing a C-section delivery at a particular hospital.</p>
<p><a href="03e-posteriors.html#exm-csec-posterior">Example&nbsp;<span>11.2</span></a> found the posterior distribution to be</p>
<p><span class="math display">\[\theta \mid \mathbf{x} \sim Beta\left(n + a, n\bar{x} + b\right)\]</span></p>
<p>where <span class="math inline">\(a = 17, b = 39, n = 15\)</span> and <span class="math inline">\(n\bar{x} = 33\)</span> given the observed data. Suppose we are interested in adding a 16-th patient to our survey; predict the number of vaginal deliveries we should expect before we observe a C-section.</p>
</div>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>We are interested in predicting a new <em>response</em> given the observed data. Following the discussion in the derivation of the posterior predictive distribution, it makes sense that we would assume the density of this new response follows the same distribution as the observed data. In particular, if <span class="math inline">\(Y\)</span> represents the future observation, then</p>
<p><span class="math display">\[f(y \mid \theta) = \theta (1 - \theta)^y\]</span></p>
<p>since each observed value (previously denoted by <span class="math inline">\(X_i\)</span>) was modeled as a random variate from a Geometric distribution. Applying <a href="#def-posterior-predictive-distribution">Definition&nbsp;<span>14.2</span></a>, we have that the posterior predictive distribution is given by</p>
<p><span class="math display">\[
\begin{aligned}
  \pi(y \mid \mathbf{x})
    &amp;= \int f\left(y \mid \theta\right) \pi(\theta \mid \mathbf{x}) d\theta \\
    &amp;= \int \theta (1 - \theta)^y \frac{\Gamma(n + a + n\bar{x} + b)}{\Gamma(n + a) \Gamma(n\bar{x} + b)} \theta^{n + a - 1} (1 - \theta)^{n\bar{x} + b - 1} d\theta \\
    &amp;= \frac{\Gamma(n + a + n\bar{x} + b)}{\Gamma(n + a) \Gamma(n\bar{x} + b)} \int \theta^{n + a + 1 - 1} (1 - \theta)^{n\bar{x} + b + y - 1} d\theta.
\end{aligned}
\]</span></p>
<p>Notice that the integrand is the kernel of a Beta distribution; therefore, we can multiply and divide by the appropriate scaling terms. This gives</p>
<p><span class="math display">\[
\begin{aligned}
  \pi(y \mid \mathbf{x})
    &amp;= \frac{\Gamma(n + a + n\bar{x} + b)}{\Gamma(n + a) \Gamma(n\bar{x} + b)} \int \theta^{n + a + 1 - 1} (1 - \theta)^{n\bar{x} + b + y - 1} d\theta \\
    &amp;= \frac{\Gamma(n + a + n\bar{x} + b)}{\Gamma(n + a) \Gamma(n\bar{x} + b)} \frac{\Gamma(n + a + 1) \Gamma(n\bar{x} + b + y)}{\Gamma(n + a + n\bar{x} + b + 1 + y)} \\
    &amp;\qquad \cdot \int \frac{\Gamma(n + a + n\bar{x} + b + 1 + y)}{\Gamma(n + a + 1) \Gamma(n\bar{x} + b + y)} \theta^{n + a + 1 - 1} (1 - \theta)^{n\bar{x} + b + y - 1} d\theta \\
    &amp;= \frac{\Gamma(n + a + n\bar{x} + b)}{\Gamma(n + a) \Gamma(n\bar{x} + b)} \frac{\Gamma(n + a + 1) \Gamma(n\bar{x} + b + y)}{\Gamma(n + a + n\bar{x} + b + 1 + y)}.
\end{aligned}
\]</span></p>
<p>We are not meant to recognize this distribution. However, we can work with it. We must keep in mind the warning, however, given just prior to this example — the support of this distribution is non-negative integers, not the interval <span class="math inline">\((0, 1)\)</span>.</p>
<p>Again, prediction is not about saying how many vaginal births we <em>will</em> see before the next C-section; it is really about quantifying our uncertainty in the various possibilities. For example, given the data observed, we are 30.8% sure that the very next birth will be a C-section, since</p>
<p><span class="math display">\[Pr(Y = 1 \mid \mathbf{x}) = \frac{\Gamma(32 + 72)}{\Gamma(32) \Gamma(72)} \frac{\Gamma(32 + 1) \Gamma(72 + 0)}{\Gamma(32 + 72 + 1 + 0)} = 0.308.\]</span></p>
<p>Similarly, we are 88.3% sure that we will not experience more than 5 vaginal births before the next C-section, since</p>
<p><span class="math display">\[Pr(Y \leq 5 \mid \mathbf{x}) \sum_{u=0}^{5} Pr(Y = u \mid \mathbf{x}) = 1 - \sum_{u=0}^{5} \frac{\Gamma(32 + 72)}{\Gamma(32) \Gamma(72)} \frac{\Gamma(32 + 1) \Gamma(72 + u)}{\Gamma(32 + 72 + 1 + u)} = 0.883.\]</span></p>
<p>However, if we would like to provide a single point estimate instead of probabilities of specific responses, we might report that, given the data, <em>on average</em>, we expect to see 2.32 vaginal deliveries before the next C-section since</p>
<p><span class="math display">\[E\left(Y \mid \mathbf{x}\right) = \sum_{u=0}^{\infty} u Pr(Y = u \mid \mathbf{x}) = 2.32.\]</span></p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03g-interval-estimation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Interval Estimation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03i-hypothesis-testing.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>