{
  "hash": "fffc046e8c93e4776cd6ff1b96f5b9e1",
  "result": {
    "markdown": "# Interval Estimation {#sec-interval-estimation}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\providecommand{\\norm}[1]{\\lVert#1\\rVert}\n\\providecommand{\\abs}[1]{\\lvert#1\\rvert}\n\\providecommand{\\iid}{\\stackrel{\\text{IID}}{\\sim}}\n\\providecommand{\\ind}{\\stackrel{\\text{Ind}}{\\sim}}\n  \n\\providecommand{\\bm}[1]{\\mathbf{#1}}\n\\providecommand{\\bs}[1]{\\boldsymbol{#1}}\n\\providecommand{\\bbeta}{\\bs{\\beta}}\n  \n\\providecommand{\\Ell}{\\mathcal{L}}\n\\providecommand{\\indep}{\\perp\\negthickspace\\negmedspace\\perp}\n\n\n\nThe previous chapter considered a single point estimate for the parameter of interest.  However, this ignores the fact that there is variability in these estimates.  The distribution itself tells us the parameter is more likely to fall in some regions than others.  In response, we consider providing a range of plausible values for the parameter and quantifying our belief that the parameter falls in that range.  This is the contrast between point and interval estimation.\n\n:::{#def-point-estimation}\n## Point Estimation\nPoint estimation is the process of estimating a parameter with a single statistic.  This is like trying to hit an infinitesimally small target with a dart.\n:::\n\n:::{#def-interval-estimation}\n## Interval Estimation\nInterval estimation is the process of estimating a parameter with a range of values.  This is like trying to capture a target with a ring.\n:::\n\nRegardless of which method we use, both are estimates, and both depend on the posterior distribution. That is, both are statements about the parameter given the observed data and our prior beliefs.  As there were various techniques for constructing a point estimate, there are various techniques for an interval estimate; the most common of these is the credible interval.\n\n:::{#def-credible-interval}\n## Credible Interval\nA $100c$% credible interval is an interval $(a, b)$ such that\n\n$$Pr(a \\leq \\theta \\leq b \\mid \\bm{y}) = \\int_{a}^{b} \\pi(\\theta \\mid \\bm{y})d\\theta = c.$$\n:::\n\n:::{.callout-warning}\nFor those who have had a previous statistics course taught from the classical Frequentist perspective, this seems to mirror a confidence interval, but the interpretation is completely different.  Since probability is used to quantify subjective beliefs, notice that the credible interval allows us to say that we are $100c$% sure the parameter falls in this range, given the data.  \n\nSince we are working from a subjective interpretation of probability, we do not need to appeal to repeated sampling (like a Frequentist would).  In fact, since a parameter is a fixed, unknown quantity, any probability statement is illogical from a Frequentist perspective.  However, from the Bayesian perspective, the posterior quantifies our uncertainty about the parameter, and therefore the credible interval is simply summarizing this uncertainty.  We can now say, based on the data observed (however much or little we have), we are $100c$% sure the parameter falls in this interval.\n:::\n\n:::{.callout-note}\nThere is no one unique credible interval for a parameter.\n:::\n   \nSince there are infinitely many regions which contain $100c$% of the posterior distribution, there are infinitely many credible intervals we could provide. In order to provide some level of continuity between applications, we tend to gravitate to one of two types of intervals which have nice properties.\n\n:::{#def-equal-tail-interval}\n## Equal-Tailed Credible Interval\nThe equal-tailed credible interval, which is probably the most commonly used in practice, chooses endpoints such that\n\n$$Pr(\\theta < a \\mid \\bm{y}) = \\frac{1-c}{2} = Pr(\\theta > b \\mid \\bm{y}).$$\n:::\n\nAs the name implies, an equal-tailed credible interval places the same probability in each tail; we are taking the middle $100c$% of the posterior distribution.  \n\nAn equal-tailed interval is easy, but it may not always be the most intuitive interval.  @fig-interval-estimation-compare-intervals compares two potential 90% credible intervals for a hypothetical posterior distribution.  Observe that the equal-tailed interval removes the bottom 5% of the distribution; while this band is narrow, it represents values which correspond to the highest posterior density values.  It seems intuitive that we would want to choose the narrowest credible interval which still retains the same area under the curve, as illustrated in the second panel of @fig-interval-estimation-compare-intervals. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![Comparison of two 90% credible intervals for a hypothetical posterior distribution.](./images/fig-interval-estimation-compare-intervals-1.png){#fig-interval-estimation-compare-intervals fig-alt='The same posterior density is plotted with two shaded regions, each representing an area of 0.90.' width=80%}\n:::\n:::\n\n\n:::{#def-hdi}\n## Highest Density Interval\nThe highest density interval, often called an HDI or HPD (for highest posterior density), chooses the endpoints such that the interval is as short as possible.\n\nWhen the density is unimodal, this can be accomplished by choosing the endpoints $a$ and $b$ such that\n    \n$$\\pi(\\theta \\mid \\bm{y}) \\mid_{\\theta = a} = \\pi(\\theta \\mid \\bm{y}) \\mid_{\\theta = b}$$\n\nand \n\n$$\\int_{a}^{b} \\pi(\\theta \\mid \\bm{y} d\\theta = c.$$\n:::\n\n:::{.callout-note}\nIf the posterior distribution is multimodal, then the highest density interval is actually a _region_ as it will likely involve two disjoint intervals.\n:::\n\n:::{.callout-warning}\nMost software that computes an HDI assumes the poterior distribution is unimodal.\n:::\n\nSuppose we have a $100c$% credible interval $(a, b)$ for some parameter $\\theta$, but we are interested in a transformation of the parameter $\\eta = g(\\theta)$.  We can develop a $100c$% credible interval for $\\eta$ by applying the same transformation to each endpoint of the interval for $\\theta$.  That is, $\\left(g(a), g(b)\\right)$ will be a $100c$% credible interval for the parameter $\\eta$ given the data. \n\nWhile we can guarantee that $\\left(g(a), g(b)\\right)$ is a $100c$% credible interval, it will in general __not__ be the HDI for $\\eta$, even if $(a, b)$ is the HDI for $\\theta$.\n\n\n:::{#exm-csec-interval-estimate}\n## C-section Deliveries Continued\n@exm-csec introduced a study, a component of which includes estimating the probability of a mother undergoing a C-section delivery at a particular hospital.  \n\n@exm-csec-posterior found the posterior distribution to be\n\n$$\\theta \\mid \\bm{x} \\sim Beta\\left(n + a, n\\bar{x} + b\\right)$$\n\nwhere $a = 17, b = 39, n = 15$ and $n\\bar{x} = 33$ given the observed data.  Estimate the rate of C-sections at the hospital given the observed data.\n:::\n\n:::{.solution}\n@exm-csec-point-estimate developed point estimates of the unknown parameter given the observed data (and prior beliefs).  Here, we consider an interval estimate.  To compute an equal-tailed interval, we must choose the values of $s$ and $t$ such that\n\n$$\n\\begin{aligned}\n  0.025 &= \\int_{0}^{s} \\frac{\\Gamma(32 + 72)}{\\Gamma(32) \\Gamma(72)} \\theta^{32 - 1} (1 - \\theta)^{72 - 1} d\\theta \\\\\n  0.025 &= \\int_{t}^{1} \\frac{\\Gamma(32 + 72)}{\\Gamma(32) \\Gamma(72)} \\theta^{32 - 1} (1 - \\theta)^{72 - 1} d\\theta. \\\\\n\\end{aligned}\n$$\n\nSolving this system numerical gives the interval $(0.223, 0.399)$.  We are 95% sure, given the data, the rate of C-sections at the hospital is between 22.3% and 39.9%.  Given that the posterior distribution is unimodal and nearly symmetric, we would expect the HDI to be very similar to the equal-tailed interval.\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}