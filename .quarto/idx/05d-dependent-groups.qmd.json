{"title":"Considerations when Comparing Related Groups","markdown":{"headingText":"Considerations when Comparing Related Groups","headingAttr":{"id":"sec-dependent-groups","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"\n{{< include _setupcode.qmd >}}\n\nThe previous chapter was a natural extension of the framework we had developed in earlier portions of the text.  Assuming each group is independent, we were essentially able to model each group separately; the likelihood was then the product of the likelihoods from each group, and the prior was the product of the priors from each group.  This independence will actually carry through into the posterior distribution.  That is, the independence allows us to model the groups separately and then combine afterwards.  However, independence between the groups is not always reasonable.\n\nRecall that one of the aspects of a good study design is comparative groups --- treatment groups which are similar except for the treatment being applied.  The benefit of this is that it reduces extraneous variability.  We also saw that blocking (@def-blocking) is a useful strategy for reducing extraneous variability that groups together observations which share some inherent characteristic.  A very common example of blocking is a pre/post test.  In such settings, participants are given a baseline assessment.  Then, each participant is exposed to some form of treatment; following this, participants take an another assessment.  Interest is typically on quantifying the change from baseline.  \n\nIn this case, the two groups (pre-treatment and post-treatment) are not only similar, they are identical!  Intuitively, this is a good design because we are allowing every individual to act as their own control.  We have eliminated all other external sources of variability allowing us to focus on the treatment of interest.  Here, the individual participants act as the blocks.  In such cases, we believe the variability among observations between blocks is greater than the variability among observations within a block.  Unfortunately, this causes a relationship among the observations, meaning it is no longer reasonable to assume the observations are independent of one another.\n\n:::{.callout-tip}\n## Big Idea\nWhen subjects can be blocked (or pooled) into similar groups, independence is no longer reasonable.\n:::\n\nWhen we believe there are clusters of related observations, we lean on the hierarchical nature of the data generating process, and this allows us to construct the likelihood.\n\n\n:::{#exm-exams}\n## Final Exams\nCommon final exams are typical for multiple sections of the same course at a university.  For example, there may be four instructors, each teaching two sections of Calculus; all eight sections will receive the same final exam.  Suppose each exam is graded out of 100 points and we are interested in modeling the exam score for students taking the exam.\n:::\n\nWe might start off by assuming a common distribution for all students.  That is,\n\n$$\n\\begin{aligned}\n  Y_i \\mid \\bs{\\theta} &\\stackrel{IID}{\\sim} f(y \\mid \\bs{\\theta}) \\\\\n  \\theta &\\sim \\pi(\\theta).\n\\end{aligned}\n$$\n\nwhere $Y_i$ is the exam score for the $i$-th subject.  However, this model is imposing a particular assumption --- there are no differences among instructors that would impact the scores of the students.  Essentially, every instructor delivers the same content in the same way suggesting the students might has well have been taught by the same instructor.  While this is a nice ideal, it is typically not the case.  Autonomy in the classroom means that different instructors approach the material differently --- emphasizing different topics and presenting the material in different ways.  As a result, it is possible that students who share an instructor are more likely to perform well on the same types of problems and also more likely to make the same types of mistakes (compared with students who do not share the same instructor).  The additional variability introduced by the differences across instructors is being ignored in this model.\n\nWe might try to correct for this by assuming the instructors are completely independent of one another, following the approach of the previous chapter.  This would say\n\n$$\n\\begin{aligned}\n  Y_{j, i} \\mid \\bs{\\theta}_j &\\stackrel{IID}{\\sim} f(y \\mid \\bs{\\theta}_j) \\\\\n  Y_{r, s} &\\indep Y_{t, u} \\quad \\forall r, s, t, u \\\\\n  \\bs{\\theta}_j &\\stackrel{Ind}{\\sim} \\pi_j(\\bs{\\theta}_j).\n\\end{aligned}\n$$\n\nHowever, this model has very limited utility in practice.  If we wanted to predict the exam score of a student taking calculus, our model would only be applicable if they were taking it with one of _these_ four instructors!  Given another student, we would need to know which of these instructors they were taking the course with in order to know which of the four parameters to lean on in predicting their score.  That is, this model inherently compares instructors; but, we do not actually care about comparing Instructor 1 and Instructor 2.  Further, the next time the course is offered, there are likely to be four completely new instructors, and we want our model to be accommodate this.  Perhaps more importantly, we do not actually think the instructors are completely unrelated (they are teaching the same major content after all...at least, we would hope so).  So, this extreme perspective also seems to ignore the structure in the problem.\n\n:::{.callout-tip}\n## Big Idea\nHow we model the relationship between groups, if one exists at all, must be based on the context of the problem.\n:::\n\nIt seems natural to think of these four instructors as a representative sample from a population of all potential instructors.  That is, we are adding a layer to the data generating process.  First, instructors are chosen to teach the course; then, students are placed with an instructor, impacting their performance on the final exam.  The way these instructors impact the data generating process is through the formation of the parameters $\\bs{\\theta}_j$.  Therefore, we incorporate this into the model.  Specifically, consider\n\n$$\n\\begin{aligned}\n  Y_{j, i} \\mid \\bs{\\theta}_j &\\stackrel{IID}{\\sim} f(y \\mid \\bs{\\theta}_j) \\\\\n  \\bs{\\theta}_j \\mid \\bs{\\eta} &\\stackrel{IID}{\\sim} \\pi(\\bs{\\theta} \\mid \\bs{\\eta}) \\\\\n  \\bs{\\eta} &\\sim \\pi(\\bs{\\eta}).\n\\end{aligned}\n$$\n\nThis model has three layers:\n\n  - Layer 1: Describes how students _within_ an instructor perform; the parameters are unique to each instructor but shared across students with the same instructor.\n  - Layer 2: Describes the variability _across_ instructors; treating the instructors as a random sample of all instructors, we allow the parameters to move across instructors according to some overall model.\n  - Layer 3: Describes our prior beliefs about the shared parameters for the instructor-level model.\n\nThis hierarchical model bridges the gap between ignoring the blocks and treating the blocks as independent groups.  This allows us to pool information similar across blocks while allowing unique properties to exist for each block as well.\n\n:::{.callout-note}\n## Hierarchical Approach to Addressing Dependence\nWhen the dependence in data is the result of a hierarchical data generating process, we can incorporate that additional variability by modeling the hierarchical structure directly.  At a minimum, this has the following three layers:\n\n  - Layer 1: Describes how observations _within_ a block behave; with parameters unique to each block.\n  - Layer 2: Describes how the parameters move _across_ blocks; this views the blocks as a random sample.\n  - Layer 3: Describes our prior beliefs on the common parameters for the model in Layer 2.\n:::\n\nIt is natural to question the difference between a block and a factor (or the grouping comparison that we considered in the previous chapter).  The difference is primarily in how we address them in the modeling.  If we are interested in making group-to-group comparisons, and if the groups would remain the same when repeating the study, the variable should be treated as a factor of interest.  If the groups primarily capture an additional source of variability and can be viewed as a random sample from some larger population, the variable should be treated as a block.\n\nOf course, we can combine the two ideas in a single study.  Suppose further that we were interested in comparing students majoring in mathematics and those not majoring in mathematics.  The first layer of the model must still describe what happens within a block (or within an instructor in our example).  The assumptions you are willing to make determine how complex this becomes.  For example, assuming that the difference between mathematics majors and non-mathematics majors is similar regardless of the instructor implies that mathematics majors share some common parameter across instructors.  However, allowing the difference to vary across instructors implies that there is no common parameter.  This is addressed within the first two layers of the model.  If the effect is held constant across the blocks, a single set of \"global\" parameters enters into Layer 1 for which priors are described in Layer 3.  If the effect is allowed to vary, then the way in which the parameters vary is defined in Layer 2.  To broaden our model above, we might have something of the form\n\n$$\n\\begin{aligned}\n  Y_{j, i} \\mid \\bs{\\theta}_j, \\bs{\\phi} &\\stackrel{IID}{\\sim} f(y \\mid \\bs{\\theta}_j, \\bs{\\phi}) \\\\\n  \\bs{\\theta}_j \\mid \\bs{\\eta} &\\stackrel{IID}{\\sim} \\pi(\\bs{\\theta} \\mid \\bs{\\eta}) \\\\\n  \\bs{\\eta} &\\sim \\pi(\\bs{\\eta}) \\\\\n  \\bs{\\phi} &\\sim \\pi(\\bs{\\phi}).\n\\end{aligned}\n$$\n\nIn this formulation, $\\bs{\\phi}$ represents parameters which are constant across the blocks; so, they are separated out from $\\bs{\\theta}_j$ as they do not vary across blocks.  We place a prior directly on these parameters in Layer 3.\n\nNote that we have been intentionally vague about the modeling structure by leaving everything in terms of $f$ instead of defining a specific model.  The form of the model will change depending on the data generating process.  Further, which parameters in that family may be altered.  For example, suppose we considered a Normal distribution for the data generating process; we could allow the mean response to vary across groups, the variability to vary across groups, both the mean response and variability to vary across groups, or hold both the mean response and variability to be similar across groups.  This is true for both the blocks as well as the treatment groups!  That is, our modeling should be specific to the question at hand and the data generating process being considered.\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["mystyles.css"],"output-file":"05d-dependent-groups.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.433","bibliography":["refs483notes.bib","packages.bib"],"comments":{"hypothesis":false},"fig-cap-location":"bottom","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":true,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"center","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"05d-dependent-groups.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["refs483notes.bib","packages.bib"],"comments":{"hypothesis":false},"fig-cap-location":"bottom","documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}